[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)

# Improving Shoreline Forecasting Models with Multi-Objective Genetic Programming
by Al Najar, M., Almar, R., Bergsma, E. W., Delvit, J. M., & Wilson, D. G. (2023). This paper has been submitted for publication in Environmental Modelling & Software.

In this work, symbolic regression is performed using CGP and NSGA-II to evolve symbolic models for shoreline forecasting. The initial population of CGP individuals are initialized as ShoreFor, a hybrid shoreline forecasting model.

<!-- ![](outputs/plots/graphs/models/nf-generalmodel-graph-NSGA-ii-ind1.png)
*Caption for the example figure with the main results.* -->


<!-- ## Abstract

Given the current context of climate change and increasing population densities at coastal zones, there is an increasing need to be able to predict the development of our coasts. Recent advances in artificial intelligence allow for automatic analysis of observational data. This work makes use of Symbolic Regression, a type of Machine Learning algorithm, to evolve interpretable shoreline forecasting models. Cartesian Genetic Programming (CGP) is used in order to encode and im- prove upon ShoreFor, a shoreline prediction model. Coupled with NSGA-II, the CGP individuals are evaluated and selected during evolution according to their predictive skills at five coastal sites. This work presents a comparison between the CGP-evolved models and the base ShoreFor model. In addition to its ability to produce well-performing models, the work demonstrates the usefulness of CGP as a research tool to gain insight into the behaviors of shorelines at different points around the globe. -->

## Implementation
The Julia programming language is used throughout this work. All source code used to generate the results and figures in the paper are in the `scripts` folder. The evolved models, evolution logs and all result plots generated by the code are saved in `outputs`.

The scripts included in this repository rely heavily on two other repositories:
* [CartesianGeneticProgramming.jl](https://github.com/mahmoud-al-najar/CartesianGeneticProgramming.jl) for the implementations of CGP and NSGA-II, and
* [Cambrian.jl](https://github.com/mahmoud-al-najar/Cambrian.jl) as the base evolutionary computation framework. 

<!-- See the `README.md` files in each directory for a full description. -->

The `scripts` directory contains the following scripts:
* `create_shorefor_ind.jl`: contains the manually-defined template of the ShoreFor model... 
* `dataloader_monthly.jl`: data loading and any preprocessing.
* `evaluation_metrics.jl`: contains different functions for model evaluation.
* `evolve_5sites.jl`: launching the experiments as described in the article.
* `model_template_utils.jl`: different utilitary functions for transforming a template into a CGP individual.
* `result_analysis.jl`: evaluating evolved populations following the article.

## Setup and dependencies
This code was developed using Julia Version 1.6.1.

First, clone/download this repository, in addition to [CartesianGeneticProgramming.jl](https://github.com/mahmoud-al-najar/CartesianGeneticProgramming.jl) and [Cambrian.jl](https://github.com/mahmoud-al-najar/Cambrian.jl). 

The julia environment that will be used to run the scripts is included in [CartesianGeneticProgramming.jl](https://github.com/mahmoud-al-najar/CartesianGeneticProgramming.jl). Before installing any dependencies, it is important to activate this environment:

```
shell> cd path/to/CartesianGeneticProgramming.jl/
pkg> activate .
(CartesianGeneticProgramming) pkg>
```

Similarly, head to the [Cambrian.jl](https://github.com/mahmoud-al-najar/Cambrian.jl) directory and put it in development mode:
```
shell> cd path/to/Cambrian.jl/
(CartesianGeneticProgramming) pkg> dev .
```

The rest of the dependencies can be installed by:
```
shell> cd path/to/CartesianGeneticProgramming.jl/
(CartesianGeneticProgramming) pkg> instantiate
(CartesianGeneticProgramming) pkg> precompile
```


## Data
The data and models presented in this work can be downloaded from: https://zenodo.org/record/8009621

The original raw data for each site was obtained from the following sources:
* Grand Popo: https://dx.doi.org/10.1088/2515-7620/ab8705
* Narrabeen: https://doi.org/10.1038/sdata.2016.24
* Duck: https://chlthredds.erdc.dren.mil/thredds/catalog/frf/catalog.html
* Torrey Pines: https://doi.org/10.1038/s41597-019-0167-6
* Truc Vert: https://doi.org/10.1038/s41597-020-00750-5

## Reproducing the results

Once the CartesianGeneticProgramming Julia environment is setup, the following variables should be adapted:=
* VARNAME (filename.jl): TODO

Finally, evolution can be launched as follows (taking into account any customization to the (dynamic) configuration file):
```
shell> cd path/to/CGP-ShoreFor/
julia> include("scripts/evolve_5sites.jl")
```

Similarly, to evaluate a set of evolved populations: 
```
julia> include("scripts/result_analysis.jl")
```

<!-- ## License
    Copyright 2023 Mahmoud Al Najar

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License. -->
